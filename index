<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Registro de Fotos – Grilazer</title>

<style>
  body {
    font-family: Arial, sans-serif;
    background: #f1f5f9;
    margin: 0;
    padding: 20px;
  }

  h2 {
    text-align: center;
    color: #0f172a;
  }

  .card {
    background: white;
    padding: 20px;
    border-radius: 16px;
    box-shadow: 0 2px 6px rgba(0,0,0,.1);
    max-width: 600px;
    margin: auto;
  }

  label {
    font-weight: bold;
    display: block;
    margin-top: 12px;
  }

  input, select {
    width: 100%;
    padding: 10px;
    border-radius: 8px;
    border: 1px solid #cbd5e1;
    margin-top: 6px;
  }

  button {
    width: 100%;
    margin-top: 20px;
    padding: 12px;
    background: #0ea5e9;
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    cursor: pointer;
  }

  button:hover {
    background: #0284c7;
  }

  .preview {
    margin-top: 15px;
    max-width: 100%;
    border-radius: 12px;
  }

  .msg {
    margin-top: 15px;
    text-align: center;
    font-weight: bold;
  }

</style>
</head>
<body>

<h2>Registro de Fotos – Grilazer</h2>

<div class="card">
  <label>Data:</label>
  <input type="date" id="data">

  <label>Fornecedor:</label>
  <select id="fornecedor">
    <option>GAAM</option>
    <option>FAESO</option>
    <option>NERCOLINI</option>
    <option>OUTRO</option>
  </select>

  <label>Observações:</label>
  <input type="text" id="obs" placeholder="Ex: Caixa amassada, divergência, etc">

  <label>Foto:</label>
  <input type="file" id="foto" accept="image/*" onchange="previewFoto()">

  <img id="preview" class="preview" style="display:none">

  <button onclick="enviarFoto()">Enviar Registro</button>

  <div id="msg" class="msg"></div>
</div>

<script>
// CONFIGURAÇÕES CLOUDINARY
const cloudName = "dx0yb48qj"; // coloque aqui o SEU cloud name
const uploadPreset = "ml_default"; // preset configurado no cloudinary

function previewFoto() {
  const file = document.getElementById("foto").files[0];
  const prev = document.getElementById("preview");

  if (file) {
    prev.src = URL.createObjectURL(file);
    prev.style.display = "block";
  }
}

async function enviarFoto() {
  const data = document.getElementById("data").value;
  const fornecedor = document.getElementById("fornecedor").value;
  const obs = document.getElementById("obs").value;
  const foto = document.getElementById("foto").files[0];
  const msg = document.getElementById("msg");

  if (!data || !foto) {
    msg.innerHTML = "Preencha a data e selecione uma foto.";
    msg.style.color = "red";
    return;
  }

  msg.innerHTML = "Enviando foto...";
  msg.style.color = "blue";

  const formData = new FormData();
  formData.append("file", foto);
  formData.append("upload_preset", uploadPreset);
  formData.append("folder", "registro_fotos");

  // Upload Photo
  const res = await fetch(`https://api.cloudinary.com/v1_1/${cloudName}/upload`, {
    method: "POST",
    body: formData
  });

  const cloudData = await res.json();

  if (cloudData.secure_url) {
    msg.innerHTML = "Registro enviado!";
    msg.style.color = "green";

    console.log("URL da imagem:", cloudData.secure_url);

  } else {
    msg.innerHTML = "Erro ao enviar!";
    msg.style.color = "red";
  }
}
</script>

</body>
</html>
